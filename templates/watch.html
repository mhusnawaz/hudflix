{% extends "base.html" %} {% block content %}
<!-- Back Button -->
<a
  href="{{ url_for('browse') }}"
  class="absolute top-8 left-8 z-50 text-white hover:text-gray-300 flex items-center gap-2"
>
  <i data-lucide="arrow-left"></i> Back to Browse
</a>

<div
  class="min-h-screen w-full flex flex-col items-center justify-center relative overflow-hidden"
>
  <!-- Cinematic Background -->
  <div class="absolute inset-0 z-0">
    <img
      src="{{ episode.image }}"
      class="w-full h-full object-cover opacity-30 blur-sm"
    />
    <div
      class="absolute inset-0 bg-gradient-to-t from-[#141414] via-[#141414]/80 to-transparent"
    ></div>
  </div>

  <!-- Content Card -->
  <div class="relative z-10 max-w-4xl w-full px-4 animate-slide-up">
    <div class="text-center mb-8">
      <span
        class="text-red-500 tracking-widest font-bold uppercase text-sm mb-2 block"
        >{{ episode.subtitle }}</span
      >
      <h1 class="text-5xl md:text-7xl font-bold mb-4">{{ episode.title }}</h1>
    </div>

    <div
      class="grid md:grid-cols-2 gap-8 items-center bg-black/40 backdrop-blur-md p-8 rounded-xl border border-white/10 shadow-2xl"
    >
      <!-- Left: Message -->
      <div class="space-y-6">
        <p
          class="text-xl md:text-2xl font-light italic text-gray-200 leading-relaxed"
        >
          "{{ episode.memory_text }}"
        </p>
        <div class="h-px w-20 bg-red-600"></div>
        <p class="text-gray-400">{{ episode.description }}</p>

        <!-- Interactive Secret -->
        {% if not is_finale %}
        <div class="mt-8">
          <label class="text-xs uppercase text-gray-500 tracking-widest"
            >Type '{{ episode.secret_answer }}' to unlock a surprise</label
          >
          <div class="flex gap-2 mt-2">
            <input
              type="text"
              id="secretInput"
              data-answer="{{ episode.secret_answer }}"
              class="bg-transparent border-b border-gray-600 focus:border-red-600 outline-none px-2 py-1 w-full transition-colors"
              placeholder="Type here..."
            />
            <button
              onclick="checkSecret()"
              class="text-red-500 hover:text-red-400"
            >
              <i data-lucide="key"></i>
            </button>
          </div>
        </div>
        {% endif %}
      </div>

      <!-- Right: Photo Placeholder/Memory -->
      <div class="relative group">
        <div
          class="aspect-[3/4] bg-gray-800 rounded-lg overflow-hidden relative shadow-lg transform rotate-2 group-hover:rotate-0 transition-all duration-500"
        >
          <img src="{{ episode.image }}" class="w-full h-full object-cover" />
          <!-- Vignette -->
          <div
            class="absolute inset-0 bg-gradient-to-b from-transparent to-black/60"
          ></div>
        </div>
      </div>
    </div>

    {% if is_finale %}
    <div class="mt-12 text-center">
      <button
        onclick="launchFinale()"
        class="bg-red-600 hover:bg-red-700 text-white px-8 py-4 rounded-full font-bold text-xl shadow-[0_0_20px_rgba(220,38,38,0.5)] animate-pulse"
      >
        ‚ù§Ô∏è Click for One Last Surprise ‚ù§Ô∏è
      </button>
    </div>
    {% endif %}
  </div>
</div>

<!-- Hidden Message Overlay -->
<div
  id="secretOverlay"
  class="fixed inset-0 bg-black/90 z-50 hidden flex-col items-center justify-center text-center p-4"
>
  <h2 class="text-4xl text-red-500 font-bebas mb-4">Secret Unlocked!</h2>
  <p class="text-2xl text-white max-w-lg">
    I love you more than code loves logic. üíñ
  </p>
  <button
    onclick="closeOverlay()"
    class="mt-8 text-gray-400 hover:text-white underline"
  >
    Close
  </button>
</div>
{% endblock %}
